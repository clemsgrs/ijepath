data:
  batch_size: 2
  pin_mem: true
  num_workers: 0
  crop_size: 224  # Model input size for both context and target crops.
  slide_manifest_csv: data/tcga-prad/manifests/tcga_prad_slides_with_tissue_masks.csv
  slide_metadata_index_jsonl: data/tcga-prad/indexes/slide_metadata_index.jsonl
  anchor_catalog_csv: data/tcga-prad/indexes/anchors_profile_ctx1p0_tgt0p5_fov512um_k4.csv
  context_mpp: 1.0
  target_mpp: 0.5
  context_fov_um: 512.0
  target_fov_um: 128.0
  targets_per_context: 4
  min_target_tissue_fraction: 0.25  # Online per-target tissue threshold during training sampling.
  insufficient_target_policy: skip_anchor  # Options: skip_anchor | skip_slide | lower_threshold.
  min_target_tissue_fraction_floor: 0.1  # Used only with lower_threshold policy.
  min_target_tissue_fraction_step: 0.05  # Threshold decrement per retry with lower_threshold.
  samples_per_epoch: 8  # Virtual dataset length per epoch.
  spacing_tolerance: 0.05  # Relative tolerance for requested-vs-source spacing matching.
  seed: 0
  wsi_backend: openslide
logging:
  folder: outputs/tcga-prad-smoke
  write_tag: jepa-smoke
mask:
  min_keep: 10
  num_enc_masks: 1
  num_pred_masks: 4  # Should match data.targets_per_context.
  patch_size: 16  # ViT patch size; also used for footprint-to-token mask conversion.
meta:
  copy_data: false
  load_checkpoint: false
  model_name: vit_tiny
  pred_depth: 3
  pred_emb_dim: 192
  read_checkpoint: null
  use_bfloat16: false
optimization:
  ema:
  - 0.996
  - 1.0
  epochs: 1
  final_lr: 1.0e-06
  final_weight_decay: 0.1
  ipe_scale: 1.0
  lr: 0.0005
  start_lr: 0.0002
  warmup: 0.1
  weight_decay: 0.04
